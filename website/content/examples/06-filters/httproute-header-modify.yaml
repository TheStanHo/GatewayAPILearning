# Request/Response Header Modification Example
# Modifies headers before forwarding (request) and before responding (response)
#
# Related Documentation: Documentation/07-request-response-modifications.md

apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: header-modify-route
spec:
  parentRefs:
    - name: my-gateway
  hostnames:
    - example.com
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /api
      filters:
        # RequestHeaderModifier: Modify headers before forwarding to backend
        - type: RequestHeaderModifier
          requestHeaderModifier:
            # add: Add new headers (doesn't overwrite existing)
            add:
              - name: X-API-Version
                value: v2
              - name: X-Forwarded-By
                value: gateway
            # set: Set/overwrite header values
            set:
              - name: X-User-ID
                value: "12345"
            # remove: Remove headers
            remove:
              - X-Sensitive-Header
        
        # ResponseHeaderModifier: Modify headers before responding to client
        - type: ResponseHeaderModifier
          responseHeaderModifier:
            add:
              - name: X-Processed-By
                value: gateway-api
              - name: X-Response-Time
                value: "100ms"
            set:
              - name: Cache-Control
                value: "no-cache, no-store"
            remove:
              - X-Internal-Header
      backendRefs:
        - name: api-service
          port: 80

