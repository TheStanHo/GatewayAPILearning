# Multiple Header Conditions Example
# Shows AND logic (all headers must match) and OR logic (multiple matches)
#
# Related Documentation: Documentation/04-advanced-routing.md

apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: multiple-headers-route
spec:
  parentRefs:
    - name: my-gateway
  hostnames:
    - example.com
  rules:
    # Rule 1: AND logic - both headers must match
    - matches:
        - headers:
            - name: X-Environment
              value: staging
            - name: X-User-Type
              value: premium
            # All headers in this array must match (AND)
      backendRefs:
        - name: premium-staging-service
          port: 80
    
    # Rule 2: OR logic - either header match
    - matches:
        # Match block 1: staging environment
        - headers:
            - name: X-Environment
              value: staging
        # Match block 2: development environment
        - headers:
            - name: X-Environment
              value: development
        # Either match block can match (OR)
      backendRefs:
        - name: non-prod-service
          port: 80
    
    # Rule 3: Feature flag routing
    - matches:
        - headers:
            - name: X-Feature-NewUI
              value: "true"
      backendRefs:
        - name: new-ui-service
          port: 80
    
    # Rule 4: Default
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: default-service
          port: 80

