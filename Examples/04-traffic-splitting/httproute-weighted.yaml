# Weighted Traffic Splitting Example
# Splits traffic between multiple backends based on weights
# This is native in Gateway API - much easier than Nginx Ingress canary annotations
#
# Related Documentation: Documentation/05-traffic-splitting.md

apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: weighted-route
spec:
  parentRefs:
    - name: my-gateway
  hostnames:
    - example.com
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        # Weights are relative percentages
        # Total: 90 + 10 = 100
        # Stable: 90 / 100 = 90% of traffic
        # Canary: 10 / 100 = 10% of traffic
        - name: stable-service
          port: 80
          weight: 90
        - name: canary-service
          port: 80
          weight: 10

